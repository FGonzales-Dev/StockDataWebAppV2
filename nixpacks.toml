[phases.install]
# Install Google Chrome and ChromeDriver with related dependencies for Selenium WebDriver
cmds = [
    "apt-get update",
    "apt-get install -y wget gnupg unzip curl ca-certificates apt-transport-https software-properties-common",
    # Install Google Chrome
    "wget -q -O - https://dl.google.com/linux/linux_signing_key.pub | apt-key add -",
    "echo 'deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main' | tee /etc/apt/sources.list.d/google-chrome.list",
    "apt-get update",
    "apt-get install -y google-chrome-stable",
    # Install ChromeDriver
    "CHROME_VERSION=$(google-chrome-stable --version | awk '{print $3}' | awk -F. '{print $1}')",
    "CHROMEDRIVER_VERSION=$(curl -s https://chromedriver.storage.googleapis.com/LATEST_RELEASE_$CHROME_VERSION)",
    "wget -q https://chromedriver.storage.googleapis.com/$CHROMEDRIVER_VERSION/chromedriver_linux64.zip",
    "unzip chromedriver_linux64.zip -d /usr/bin/",
    "chmod +x /usr/bin/chromedriver",
    "rm chromedriver_linux64.zip",
    # Install virtual display
    "apt-get install -y xvfb",
    # Clean up
    "apt-get clean",
    "rm -rf /var/lib/apt/lists/*"
]

[phases.setup]
# Setup Chrome and configure environment
cmds = [
    "which google-chrome-stable || echo 'Chrome not found'",
    "google-chrome-stable --version || echo 'Chrome version check failed'",
    "which chromedriver || echo 'ChromeDriver not found'",
    "chromedriver --version || echo 'ChromeDriver version check failed'",
    "export CHROME_BIN=/usr/bin/google-chrome-stable",
    "export CHROMEDRIVER_PATH=/usr/bin/chromedriver"
]

[variables]
# Environment variables for Chrome/ChromeDriver
CHROME_BIN = "/usr/bin/google-chrome-stable"
CHROMEDRIVER_PATH = "/usr/bin/chromedriver"
DISPLAY = ":99" 